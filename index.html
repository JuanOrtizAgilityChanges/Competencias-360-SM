<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matriz de Competencias Shu-Ha-Ri</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f6fa;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: #f5f6fa;
        }

        .header {
            background-color: #00008F;
            padding: 20px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .header-decoration {
            position: absolute;
            top: -20px;
            right: -20px;
            width: 200px;
            height: 200px;
            background: #FF1721;
            transform: rotate(45deg);
            opacity: 0.3;
        }

        .header h1 {
            margin: 0;
            position: relative;
            z-index: 1;
        }

        .header p {
            margin: 5px 0 0 0;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .tabs {
            background-color: white;
            border-bottom: 2px solid #E6E9FF;
            display: flex;
            overflow-x: auto;
        }

        .tab-button {
            padding: 15px 25px;
            border: none;
            background-color: transparent;
            color: #2c3e50;
            cursor: pointer;
            font-size: 14px;
            font-weight: normal;
            border-bottom: none;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab-button.active {
            background-color: #00008F;
            color: white;
            font-weight: bold;
            border-bottom: 3px solid #FF1721;
        }

        .tab-button:hover {
            background-color: #E6E9FF;
        }

        .tab-button.active:hover {
            background-color: #00008F;
        }

        .content {
            padding: 20px;
        }

        .card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .card h3 {
            margin-top: 0;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }

        .competencia-section {
            margin-bottom: 25px;
        }

        .competencia-title {
            color: #00008F;
            margin-bottom: 10px;
            border-bottom: 2px solid #FF1721;
            padding-bottom: 5px;
        }

        .comentario {
            margin-bottom: 10px;
            padding-left: 15px;
            border-left: 3px solid #ecf0f1;
        }

        .comentario-texto {
            margin: 5px 0;
            color: #34495e;
        }

        .comentario-autor {
            margin: 5px 0;
            font-size: 12px;
            color: #7f8c8d;
            font-style: italic;
        }

        .comentario-general {
            margin-bottom: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #FF1721;
        }

        .comentario-general-texto {
            margin: 0 0 8px 0;
            color: #2c3e50;
            line-height: 1.6;
        }

        .comentario-general-autor {
            margin: 0;
            font-size: 13px;
            color: #7f8c8d;
            font-style: italic;
            text-align: right;
        }

        .footer {
            padding: 20px;
            text-align: center;
            color: #7f8c8d;
            font-size: 12px;
        }

        .footer p {
            margin: 5px 0;
        }

        .legend-item {
            display: inline-block;
            margin: 0 10px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-decoration"></div>
            <h1>Matriz de Competencias Shu-Ha-Ri</h1>
            <p>Dashboard de Evaluación 360° - Product Managers & Scrum Masters</p>
        </div>

        <div class="tabs" id="tabs"></div>

        <div id="content"></div>

        <div class="footer">
            <p>Evaluación basada en el sistema Shu-Ha-Ri</p>
            <p>
                <span class="legend-item"><span style="color: #00008F;">■</span> SHU (Maestro Alto)</span>
                <span class="legend-item"><span style="color: #FF1721;">■</span> HA (Practicante Medio)</span>
                <span class="legend-item"><span style="color: #FF6B6B;">■</span> RI (Aprendiz Bajo)</span>
            </p>
        </div>
    </div>

    <script>
        const rawData = `1;24/09/2025 14:50;24/09/2025 14:52;anonymous;;Maria V Mejora;Maria V Mejora;HA (Practicante) Medio;;HA (Practicante) Medio;;HA (Practicante) Medio;Creo que en trabajo en equipo, le falta confiar mas en su equipo y soltar ;SHU (Maestro) Alto;;HA (Practicante) Medio;;SHU (Maestro) Alto;;Debemos mejorar en el micromanager, ya que el trabajo en equipo se trata de creer en el la otra persona y confiar, en su trabajo, esto le permite crecer mucho mas, ;
2;01/10/2025 8:03;01/10/2025 8:12;anonymous;;Diana Mesa;Diana Mesa;HA (Practicante) Medio;;RI (Aprendiz) Bajo;;RI (Aprendiz) Bajo;;HA (Practicante) Medio;;HA (Practicante) Medio;;RI (Aprendiz) Bajo;;Quiero agradecerte por tu positividad y por mantener una sonrisa constante. También quiero comentar una oportunidad de mejora: en algunos momentos se han generado discusiones con colegas, lo que ha generado indisposición en el equipo. Sería útil trabajar en inteligencia emocional y en prácticas de trabajo en equipo para evitar conflictos y mejorar la colaboración. ;
3;01/10/2025 8:12;01/10/2025 8:14;anonymous;;Jessica Contreras;Jessica Contreras;HA (Practicante) Medio;;HA (Practicante) Medio;;SHU (Maestro) Alto;;HA (Practicante) Medio;;HA (Practicante) Medio;;HA (Practicante) Medio;;Jessica eres muy pila, se nota cada día aprendes mucho mas y eres excelente trabajando en equipo, ;
4;01/10/2025 15:48;01/10/2025 15:50;anonymous;;Steven Gonzalez;Steven Gonzalez;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;No Tengo Suficiente Información;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;;
5;01/10/2025 15:46;01/10/2025 15:56;anonymous;;Steven Gonzalez;Steven Gonzalez;SHU (Maestro) Alto;Excelente comunicación, manejo de lenguaje asertivo y fluidez con elocuencia y puntualidad en el mensaje;SHU (Maestro) Alto;Conecta con el equipo y propone ideas;SHU (Maestro) Alto;Excelente disposición y apoyo;SHU (Maestro) Alto;Orientación al logro y gestión con proposito;HA (Practicante) Medio;Aunque no he tenido una situación puntual vista para esta habilidad, es muy receptivo y flexible a nuevas ideas;SHU (Maestro) Alto;Conocimiento excepcional, de varias metodologías, adicionalmente cuenta ;Felicitaciones!!!  Tus conocimientos, profesionalismo y excelente actitud, son inspiradores y motivan la implementación de grandes proyectos.;Carol Rocio Rodriguez Guerrero
6;02/10/2025 8:23;02/10/2025 8:25;anonymous;;Carlos Torres;Carlos Torres;SHU (Maestro) Alto;Tiene habilidades de comunicación;SHU (Maestro) Alto;Muestra su liderazgo y experiencia;SHU (Maestro) Alto;Tiene apertura para trabajo en equipo;SHU (Maestro) Alto;Excelente en entrega de resultados ;HA (Practicante) Medio;Al principio senti que le costo un poco, pero puso adaptarse a la cultura;SHU (Maestro) Alto;Excelente ;Es un Ingeniero con muy buenas habilidades y herramientas de gestión de proyectos;Johanna Skinner
7;02/10/2025 8:26;02/10/2025 8:45;anonymous;;Maria V Mejora;Maria V Mejora;SHU (Maestro) Alto;Es una lider con un excelente nivel de comunicación;SHU (Maestro) Alto;Es una colaboradora que muestra Liderazgo en su trabajo diario ;SHU (Maestro) Alto;Gestiona equipos y tiene habilidades para trabajo en equipo;SHU (Maestro) Alto;Maneja foco en los resultados en los proyectos que dirige;SHU (Maestro) Alto;Tiene buena gestión del cambio ;SHU (Maestro) Alto;Es muy organizada, estricta y conoce herramientas de seguimiento y manejo de proyectos;Es muy buena lider de proyectos, tiene una actitud de servicio ;Johanna Skinner
8;02/10/2025 9:19;02/10/2025 9:24;anonymous;;Steven Gonzalez;Steven Gonzalez;SHU (Maestro) Alto;En las interacciones que he tenido la comunicación ha sido clara.;No Tengo Suficiente Información;N.A.;SHU (Maestro) Alto;Comparte su conocimiento y buenas prácticas.;No Tengo Suficiente Información;No aplica;No Tengo Suficiente Información;No aplica;SHU (Maestro) Alto;Evidencio un conocimiento claro de su rol y su acoplamiento con la metodología de la PMO;Mis interacciones con Steven ha sido muy puntuales, sin embargo, valoro mucho las practicas propuestas (Ej: Managment 3.0) para el fortalecimiento del equipo y que comparte su conocimiento referente a la metodología de proyectos o buenas prácticas.;María E. Alarcón
9;07/10/2025 9:03;07/10/2025 9:26;anonymous;;Maria V Mejia;Maria V Mejia;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;María Victoria tiene un alto nivel de organización, seguimiento y creatividad, así como una importante habilidad para entender y comprender rápidamente los procesos nuevos, lo que le permite generar y aportar nuevas ideas para asegurar el éxito en cada proyecto.   ;Manuel Ricardo Jaime Gallo
10;08/10/2025 17:01;08/10/2025 17:05;anonymous;;Maria V Mejia;Maria V Mejia;SHU (Maestro) Alto;;RI (Aprendiz) Bajo;podria asignar mas reponsabilidades y no solo tareas;HA (Practicante) Medio;;HA (Practicante) Medio;;RI (Aprendiz) Bajo;;HA (Practicante) Medio;podria re-pensar como y cuando adaptar las metodologias acorde a los resultados requeridos para el negocio;Maria V, es clara en la presentación de sus puntos en las sesiones, puede ser un poco emocional en su comunicación en ocasiones, y se ve que hasta que no haya una oficialización de los cambios le puede costar asumirlos;
11;09/10/2025 6:50;09/10/2025 6:54;anonymous;;Maria V Mejia;Maria V Mejia;SHU (Maestro) Alto;;HA (Practicante) Medio;;HA (Practicante) Medio;;HA (Practicante) Medio;;HA (Practicante) Medio;;SHU (Maestro) Alto;;Navegas muy bien en la compañía y tienes buen olfato para detectar las motivaciones internas . Eres muy enfocada en el logro, solo te recomendaría tomarte una pausa para pensar porque puedes llegar a ser muy acelerada y eso puede jugar en contra de la calidad.;
12;09/10/2025 9:50;09/10/2025 9:55;anonymous;;Carlos Torres;Carlos Torres;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;Es un excelente profesional, promueve el trabajo en equipo, apoya en lo necesario para todo lo que se requiera del proyecto en temas funcionales y hasta técnicos. Transmite con claridad sus necesidades, preocupaciones a nivel del proyecto. Excelente inteligencia emocional ;Fredy Sanabria
13;09/10/2025 18:43;09/10/2025 18:46;anonymous;;Carlos Torres;Carlos Torres;SHU (Maestro) Alto;En las interacciones que he tenido con Carlos en diferentes escenarios he evidenciado esta habilidad.;HA (Practicante) Medio;Considero que es uno de los aspectos que debe seguir fortaleciendo.;SHU (Maestro) Alto;Ninguno.;SHU (Maestro) Alto;Ninguno;No Tengo Suficiente Información;N.A.;SHU (Maestro) Alto;Se evidencia su conocimiento en las metodologías.;Su organización permite que el proyecto fluya de una manera eficiente y efectiva. Considero que seguir trabajando en la flexibilidad.;María E. Alarcón
14;10/10/2025 10:01;10/10/2025 10:24;anonymous;;Carlos Torres;Carlos Torres;SHU (Maestro) Alto;La comunicación en transparente y efectiva;SHU (Maestro) Alto;Gran capacidad para organizar y motivar no lo su equipo asiganados, sino también, los diferntes grupos de trabajo;No Tengo Suficiente Información;;SHU (Maestro) Alto;;No Tengo Suficiente Información;;SHU (Maestro) Alto;;Es clara la experiencia y dominio los temas, y desde mi visión resulta de gran valor que el conocimiento en temas técnicos relacionado a datos. También, destaco el interes y la capacidad de gestionar todo lo posible en pro a cumplir las mesas propuestas.;Camilo Andrés Ramírez
15;10/10/2025 11:42;10/10/2025 18:07;anonymous;;Carlos Torres;Carlos Torres;SHU (Maestro) Alto;;HA (Practicante) Medio;Muestra una buena disposición para colaborar y apoyar al equipo, pero aún hay oportunidades de mejora en cuanto a delegar con mayor autonomía, especialmente al permitir que roles como el de Business Analyst (BA) desarrollen completamente sus responsabilidades. Con pequeños ajustes en este aspecto, podría potenciar aún más el liderazgo y la motivación dentro del equipo.;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;SHU (Maestro) Alto;;;`;

        const competencias = [
            { nombre: 'Comunicación', idxCalif: 7, idxFeedback: 8 },
            { nombre: 'Liderazgo', idxCalif: 9, idxFeedback: 10 },
            { nombre: 'Trabajo Equipo', idxCalif: 11, idxFeedback: 12 },
            { nombre: 'Orient. Resultados', idxCalif: 13, idxFeedback: 14 },
            { nombre: 'Adaptación', idxCalif: 15, idxFeedback: 16 },
            { nombre: 'Metodologías', idxCalif: 17, idxFeedback: 18 }
        ];

        function normalizeNombre(nombre) {
            if (!nombre) return '';
            const trimmed = nombre.trim();
            if (trimmed.includes('Maria V Mejia') || trimmed.includes('Maria V Mejora')) {
                return 'Maria V Mejia';
            }
            return trimmed;
        }

        function parseCSV(csv) {
            const lines = csv.split('\n').filter(line => line.trim().match(/^\d+;/));
            const data = [];
            
            for (let line of lines) {
                const values = line.split(';');
                if (values.length >= 20) {
                    data.push(values);
                }
            }
            return data;
        }

        function calcularPorcentajes(calificaciones) {
            const validas = calificaciones.filter(c => !c.includes('No Tengo'));
            
            if (validas.length === 0) {
                return { SHU: 0, HA: 0, RI: 0, total: 0 };
            }
            
            const counts = {
                SHU: validas.filter(c => c.includes('SHU')).length,
                HA: validas.filter(c => c.includes('HA')).length,
                RI: validas.filter(c => c.includes('RI')).length
            };
            
            const total = validas.length;
            
            return {
                SHU: Math.round((counts.SHU / total) * 100),
                HA: Math.round((counts.HA / total) * 100),
                RI: Math.round((counts.RI / total) * 100),
                total: total
            };
        }

        const parsedData = parseCSV(rawData);
        const personasData = {};
        
        parsedData.forEach(values => {
            const persona = normalizeNombre(values[6]);
            const evaluador = (values[20] || '').trim() || 'Anónimo';
            
            if (!persona) return;
            
            if (!personasData[persona]) {
                personasData[persona] = {
                    evaluaciones: {},
                    comentariosGenerales: []
                };
                
                competencias.forEach(comp => {
                    personasData[persona].evaluaciones[comp.nombre] = {
                        calificaciones: [],
                        comentarios: []
                    };
                });
            }
            
            competencias.forEach(comp => {
                const calif = (values[comp.idxCalif] || '').trim();
                const feedback = (values[comp.idxFeedback] || '').trim();
                
                if (calif) {
                    personasData[persona].evaluaciones[comp.nombre].calificaciones.push(calif);
                }
                
                if (feedback) {
                    personasData[persona].evaluaciones[comp.nombre].comentarios.push({
                        texto: feedback,
                        evaluador: evaluador
                    });
                }
            });
            
            const comentarioGeneral = (values[19] || '').trim();
            if (comentarioGeneral) {
                personasData[persona].comentariosGenerales.push({
                    texto: comentarioGeneral,
                    evaluador: evaluador
                });
            }
        });

        const personas = Object.keys(personasData);
        let activeTab = -1;
        let currentChart = null;

        function renderTabs() {
            const tabsContainer = document.getElementById('tabs');
            tabsContainer.innerHTML = '';

            const consolidadoTab = document.createElement('button');
            consolidadoTab.className = 'tab-button' + (activeTab === -1 ? ' active' : '');
            consolidadoTab.textContent = '📊 Consolidado del Equipo';
            consolidadoTab.onclick = () => switchTab(-1);
            tabsContainer.appendChild(consolidadoTab);

            personas.forEach((persona, idx) => {
                const tab = document.createElement('button');
                tab.className = 'tab-button' + (activeTab === idx ? ' active' : '');
                tab.textContent = persona;
                tab.onclick = () => switchTab(idx);
                tabsContainer.appendChild(tab);
            });
        }

        function switchTab(idx) {
            activeTab = idx;
            renderTabs();
            if (idx === -1) {
                renderConsolidado();
            } else {
                renderPersona(personas[idx]);
            }
        }

        function renderConsolidado() {
            const consolidado = competencias.map(comp => {
                let totalSHU = 0, totalHA = 0, totalRI = 0, totalEval = 0;
                
                personas.forEach(persona => {
                    const evaluacion = personasData[persona].evaluaciones[comp.nombre];
                    const validas = evaluacion.calificaciones.filter(c => !c.includes('No Tengo'));
                    
                    totalSHU += validas.filter(c => c.includes('SHU')).length;
                    totalHA += validas.filter(c => c.includes('HA')).length;
                    totalRI += validas.filter(c => c.includes('RI')).length;
                    totalEval += validas.length;
                });
                
                return {
                    competencia: comp.nombre,
                    SHU: totalEval > 0 ? Math.round((totalSHU / totalEval) * 100) : 0,
                    HA: totalEval > 0 ? Math.round((totalHA / totalEval) * 100) : 0,
                    RI: totalEval > 0 ? Math.round((totalRI / totalEval) * 100) : 0,
                    total: totalEval
                };
            });

            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="content">
                    <h2 style="margin-bottom: 20px; color: #00008F;">Consolidado del Equipo</h2>
                    <div class="card">
                        <h3>Distribución General de Calificaciones Shu-Ha-Ri</h3>
                        <div class="chart-container">
                            <canvas id="consolidadoChart"></canvas>
                        </div>
                    </div>
                </div>
            `;

            if (currentChart) {
                currentChart.destroy();
            }

            const ctx = document.getElementById('consolidadoChart').getContext('2d');
            currentChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: consolidado.map(d => d.competencia),
                    datasets: [
                        {
                            label: 'SHU (Maestro)',
                            data: consolidado.map(d => d.SHU),
                            backgroundColor: '#00008F',
                            stack: 'Stack 0'
                        },
                        {
                            label: 'HA (Practicante)',
                            data: consolidado.map(d => d.HA),
                            backgroundColor: '#FF1721',
                            stack: 'Stack 0'
                        },
                        {
                            label: 'RI (Aprendiz)',
                            data: consolidado.map(d => d.RI),
                            backgroundColor: '#FF6B6B',
                            stack: 'Stack 0'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                footer: function(context) {
                                    const index = context[0].dataIndex;
                                    return 'Total evaluaciones del equipo: ' + consolidado[index].total;
                                }
                            }
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            stacked: true,
                            title: {
                                display: true,
                                text: '% de Evaluaciones'
                            }
                        }
                    }
                }
            });
        }

        function renderPersona(persona) {
            const graficaData = [];
            
            competencias.forEach(comp => {
                const evaluacion = personasData[persona].evaluaciones[comp.nombre];
                const porcentajes = calcularPorcentajes(evaluacion.calificaciones);
                
                graficaData.push({
                    competencia: comp.nombre,
                    SHU: porcentajes.SHU,
                    HA: porcentajes.HA,
                    RI: porcentajes.RI,
                    total: porcentajes.total
                });
            });

            let comentariosHTML = '';
            competencias.forEach(comp => {
                const comentarios = personasData[persona].evaluaciones[comp.nombre].comentarios;
                if (comentarios.length === 0) return;
                
                comentariosHTML += `
                    <div class="competencia-section">
                        <h4 class="competencia-title">${comp.nombre}</h4>
                        ${comentarios.map(comentario => `
                            <div class="comentario">
                                <p class="comentario-texto">"${comentario.texto}"</p>
                                <p class="comentario-autor">— ${comentario.evaluador}</p>
                            </div>
                        `).join('')}
                    </div>
                `;
            });

            let comentariosGeneralesHTML = personasData[persona].comentariosGenerales.map(comentario => `
                <div class="comentario-general">
                    <p class="comentario-general-texto">${comentario.texto}</p>
                    <p class="comentario-general-autor">— ${comentario.evaluador}</p>
                </div>
            `).join('');

            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="content">
                    <h2 style="margin-bottom: 20px; color: #00008F;">${persona}</h2>
                    
                    <div class="card">
                        <h3>Distribución de Calificaciones Shu-Ha-Ri</h3>
                        <div class="chart-container">
                            <canvas id="personaChart"></canvas>
                        </div>
                    </div>

                    <div class="card">
                        <h3>Comentarios por Competencia</h3>
                        ${comentariosHTML}
                    </div>

                    <div class="card">
                        <h3>Comentarios Generales</h3>
                        ${comentariosGeneralesHTML}
                    </div>
                </div>
            `;

            if (currentChart) {
                currentChart.destroy();
            }

            const ctx = document.getElementById('personaChart').getContext('2d');
            currentChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: graficaData.map(d => d.competencia),
                    datasets: [
                        {
                            label: 'SHU (Maestro)',
                            data: graficaData.map(d => d.SHU),
                            backgroundColor: '#00008F',
                            stack: 'Stack 0'
                        },
                        {
                            label: 'HA (Practicante)',
                            data: graficaData.map(d => d.HA),
                            backgroundColor: '#FF1721',
                            stack: 'Stack 0'
                        },
                        {
                            label: 'RI (Aprendiz)',
                            data: graficaData.map(d => d.RI),
                            backgroundColor: '#FF6B6B',
                            stack: 'Stack 0'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                footer: function(context) {
                                    const index = context[0].dataIndex;
                                    return 'Total evaluaciones: ' + graficaData[index].total;
                                }
                            }
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            stacked: true,
                            title: {
                                display: true,
                                text: '% de Evaluaciones'
                            }
                        }
                    }
                }
            });
        }

        // Inicializar
        renderTabs();
        renderConsolidado();
    </script>
</body>
</html>
